<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.18.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- LINDAREX :: JEKYLL SEO TAG :: BIGIN -->
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>AWS EC2 우분투(Ubuntu) 환경에 BOSH director 설치하기 | LindaRex</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="AWS EC2 우분투(Ubuntu) 환경에 BOSH director 설치하기" />
<meta name="author" content="Rex" />
<meta property="og:locale" content="ko_KR" />
<meta name="description" content="Cloud Foundry BOSH는 소규모 및 대규모 클라우드(cloud) 애플리케이션(application)의 배포와 라이프 사이클 관리, release engineering을 통합하는 오픈소스(open source) 소프트웨어 프로젝트입니다. BOSH는 수백 개의 가상머신(VM, virtual machine)에 application을 프로비저닝(provisioning)하고 배포할 수 있으며, 모니터링과 오류 복구, application 업데이트를 수행합니다. BOSH는 Cloud Foundry PaaS(CFAR) 배포를 위해 개발되었지만, 거의 모든 소프트웨어를 배포하는 데에도 사용할 수 있습니다. 예를 들면, Hadoop 또는 Jenkins 등의 오픈소스 소프트웨어를 BOSH release로 작성하여 배포할 수 있으며 대규모 분산 시스템(system)에 적합합니다. 또한 BOSH는 Amazon Web Services EC2, Google Cloud Platform, Microsoft Azure, OpenStack, VMware vSphere 및 Alibaba Cloud와 같은 다양한 IaaS(infrastructure as a service) provider를 지원하며, Apache CloudStack, VirtualBox 등의 IaaS provider 지원을 위해 CPI(cloud provider interface)를 제공합니다. 이 포스트에서는 AWS EC2 우분투(ubuntu) 환경에서 BOSH 사용을 위한 BOSH director를 설치하는 방법을 소개합니다." />
<meta property="og:description" content="Cloud Foundry BOSH는 소규모 및 대규모 클라우드(cloud) 애플리케이션(application)의 배포와 라이프 사이클 관리, release engineering을 통합하는 오픈소스(open source) 소프트웨어 프로젝트입니다. BOSH는 수백 개의 가상머신(VM, virtual machine)에 application을 프로비저닝(provisioning)하고 배포할 수 있으며, 모니터링과 오류 복구, application 업데이트를 수행합니다. BOSH는 Cloud Foundry PaaS(CFAR) 배포를 위해 개발되었지만, 거의 모든 소프트웨어를 배포하는 데에도 사용할 수 있습니다. 예를 들면, Hadoop 또는 Jenkins 등의 오픈소스 소프트웨어를 BOSH release로 작성하여 배포할 수 있으며 대규모 분산 시스템(system)에 적합합니다. 또한 BOSH는 Amazon Web Services EC2, Google Cloud Platform, Microsoft Azure, OpenStack, VMware vSphere 및 Alibaba Cloud와 같은 다양한 IaaS(infrastructure as a service) provider를 지원하며, Apache CloudStack, VirtualBox 등의 IaaS provider 지원을 위해 CPI(cloud provider interface)를 제공합니다. 이 포스트에서는 AWS EC2 우분투(ubuntu) 환경에서 BOSH 사용을 위한 BOSH director를 설치하는 방법을 소개합니다." />
<link rel="canonical" href="https://lindarex.github.io/bosh/ubuntu-bosh-director-installation/" />
<meta property="og:url" content="https://lindarex.github.io/bosh/ubuntu-bosh-director-installation/" />
<meta property="og:site_name" content="LindaRex" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-02-20T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="AWS EC2 우분투(Ubuntu) 환경에 BOSH director 설치하기" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@Rex" />
<meta name="google-site-verification" content="t6VkmqsI15sIx3P1-gh3NYputZtjhDZOTkxhwDaa4Ik" />
<script type="application/ld+json">
{"datePublished":"2020-02-20T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://lindarex.github.io/bosh/ubuntu-bosh-director-installation/"},"@type":"BlogPosting","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://lindarex.github.io/assets/images/LindaRex_LOGO.jpg"},"name":"Rex"},"url":"https://lindarex.github.io/bosh/ubuntu-bosh-director-installation/","author":{"@type":"Person","name":"Rex"},"headline":"AWS EC2 우분투(Ubuntu) 환경에 BOSH director 설치하기","description":"Cloud Foundry BOSH는 소규모 및 대규모 클라우드(cloud) 애플리케이션(application)의 배포와 라이프 사이클 관리, release engineering을 통합하는 오픈소스(open source) 소프트웨어 프로젝트입니다. BOSH는 수백 개의 가상머신(VM, virtual machine)에 application을 프로비저닝(provisioning)하고 배포할 수 있으며, 모니터링과 오류 복구, application 업데이트를 수행합니다. BOSH는 Cloud Foundry PaaS(CFAR) 배포를 위해 개발되었지만, 거의 모든 소프트웨어를 배포하는 데에도 사용할 수 있습니다. 예를 들면, Hadoop 또는 Jenkins 등의 오픈소스 소프트웨어를 BOSH release로 작성하여 배포할 수 있으며 대규모 분산 시스템(system)에 적합합니다. 또한 BOSH는 Amazon Web Services EC2, Google Cloud Platform, Microsoft Azure, OpenStack, VMware vSphere 및 Alibaba Cloud와 같은 다양한 IaaS(infrastructure as a service) provider를 지원하며, Apache CloudStack, VirtualBox 등의 IaaS provider 지원을 위해 CPI(cloud provider interface)를 제공합니다. 이 포스트에서는 AWS EC2 우분투(ubuntu) 환경에서 BOSH 사용을 위한 BOSH director를 설치하는 방법을 소개합니다.","dateModified":"2020-02-20T00:00:00+09:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<!-- LINDAREX :: JEKYLL SEO TAG :: END -->

<!-- LINDAREX :: NAVER SITE VERIFICATION :: BIGIN -->
<meta name="naver-site-verification" content="190d9b8e0a63058b72f2031ce67825da7b9038f5">
<!-- LINDAREX :: NAVER SITE VERIFICATION :: END -->

<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="LindaRex Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- LINDAREX :: FAVICON :: BIGIN -->
<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico">
<!-- LINDAREX :: FAVICON :: END -->

<!-- LINDAREX :: FEED :: BIGIN -->
<!-- <link rel="alternate" type="application/rss+xml" href="https://lindarex.github.io/feed.xml" title="LindaRex Feed"> -->
<!-- LINDAREX :: FEED :: END -->

<!-- LINDAREX :: GOOGLE ANALYTICS :: BIGIN -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-157973560-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-157973560-1');
</script>
<!-- LINDAREX :: GOOGLE ANALYTICS :: END -->

<!-- LINDAREX :: NAVER ANALYTICS :: BIGIN -->
<!-- Naver Analytics -->
<script type="text/javascript" src="//wcs.naver.net/wcslog.js"></script>
<script type="text/javascript">
if(!wcs_add) var wcs_add = {};
wcs_add["wa"] = "42df78a7dfd6f0";
wcs_do();
</script>
<!-- LINDAREX :: NAVER ANALYTICS :: END -->

<!-- LINDAREX :: GOOGLE ADSENSE :: BIGIN -->
<script data-ad-client="ca-pub-8367174639781348" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- LINDAREX :: GOOGLE ADSENSE :: END -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/LindaRex_LOGO.jpg" alt="LindaRex logo"></a>
        
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/year-archive/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">OPEN SOURCE SOFTWARE</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/categories/jenkins/" class="">JENKINS</a></li>
          
            
            

            
            

            <li><a href="/categories/sonarqube/" class="">SONARQUBE</a></li>
          
            
            

            
            

            <li><a href="/categories/scm-manager/" class="">SCM MANAGER</a></li>
          
            
            

            
            

            <li><a href="/categories/postgresql/" class="">POSTGRESQL</a></li>
          
            
            

            
            

            <li><a href="/categories/elastic-stack/" class="">ELASTIC STACK</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">CLOUD FOUNDRY</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/categories/bosh/" class="">BOSH</a></li>
          
            
            

            
            

            <li><a href="/categories/cfar/" class="">CFAR</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">CLOUD COMPUTING</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/categories/aws/" class="">AWS</a></li>
          
            
            

            
            

            <li><a href="/categories/azure/" class="">AZURE</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">INTERESTED</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/categories/ubuntu/" class="">UBUNTU</a></li>
          
            
            

            
            

            <li><a href="/categories/concepts/" class="">CONCEPTS</a></li>
          
            
            

            
            

            <li><a href="/categories/vmware-workstation/" class="">VMWARE WORKSTATION</a></li>
          
            
            

            
            

            <li><a href="/categories/travis-ci/" class="">TRAVIS CI</a></li>
          
        </ul>
        
      </li>
    
  </ul>
  <!-- LINDAREX :: GOOGLE ADSENSE :: LEFT-SIDEBAR :: BIGIN-->
  <!-- LINDAREX :: GOOGLE ADSENSE :: LEFT-SIDEBAR :: HTML :: BIGIN -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 2020-02-22-ad-left-sidebar -->
<ins class="adsbygoogle"
     style="display:inline-block;width:200px;height:200px"
     data-ad-client="ca-pub-8367174639781348"
     data-ad-slot="5840394475"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<!-- LINDAREX :: GOOGLE ADSENSE :: LEFT-SIDEBAR :: HTML :: END -->

  <!-- LINDAREX :: GOOGLE ADSENSE :: LEFT-SIDEBAR :: END-->
</nav>
    
  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="AWS EC2 우분투(Ubuntu) 환경에 BOSH director 설치하기">
    <meta itemprop="description" content="Cloud Foundry BOSH는 소규모 및 대규모 클라우드(cloud) 애플리케이션(application)의 배포와 라이프 사이클 관리, release engineering을 통합하는 오픈소스(open source) 소프트웨어 프로젝트입니다. BOSH는 수백 개의 가상머신(VM, virtual machine)에 application을 프로비저닝(provisioning)하고 배포할 수 있으며, 모니터링과 오류 복구, application 업데이트를 수행합니다. BOSH는 Cloud Foundry PaaS(CFAR) 배포를 위해 개발되었지만, 거의 모든 소프트웨어를 배포하는 데에도 사용할 수 있습니다. 예를 들면, Hadoop 또는 Jenkins 등의 오픈소스 소프트웨어를 BOSH release로 작성하여 배포할 수 있으며 대규모 분산 시스템(system)에 적합합니다. 또한 BOSH는 Amazon Web Services EC2, Google Cloud Platform, Microsoft Azure, OpenStack, VMware vSphere 및 Alibaba Cloud와 같은 다양한 IaaS(infrastructure as a service) provider를 지원하며, Apache CloudStack, VirtualBox 등의 IaaS provider 지원을 위해 CPI(cloud provider interface)를 제공합니다. 이 포스트에서는 AWS EC2 우분투(ubuntu) 환경에서 BOSH 사용을 위한 BOSH director를 설치하는 방법을 소개합니다.">
    <meta itemprop="datePublished" content="2020-02-20T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">AWS EC2 우분투(Ubuntu) 환경에 BOSH director 설치하기
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
          
          <!-- LINDAREX :: GOOGLE ADSENSE :: RIGHT-SIDEBAR :: BIGIN -->
          
            <nav class="toc-custom">
            <!-- LINDAREX :: GOOGLE ADSENSE :: RIGHT-SIDEBAR :: HTML :: BIGIN -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 2020-02-22-ad-right-sidebar -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8367174639781348"
     data-ad-slot="5781712397"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<!-- LINDAREX :: GOOGLE ADSENSE :: RIGHT-SIDEBAR :: HTML :: END -->

            </nav>
          
          <!-- LINDAREX :: GOOGLE ADSENSE :: RIGHT-SIDEBAR :: END -->
          </aside>
        
        <p>Cloud Foundry BOSH는 소규모 및 대규모 클라우드(cloud) 애플리케이션(application)의 배포와 라이프 사이클 관리, release engineering을 통합하는 오픈소스(open source) 소프트웨어 프로젝트입니다. 
BOSH는 수백 개의 가상머신(VM, virtual machine)에 application을 프로비저닝(provisioning)하고 배포할 수 있으며, 모니터링과 오류 복구, application 업데이트를 수행합니다. <br />
BOSH는 Cloud Foundry PaaS(CFAR) 배포를 위해 개발되었지만, 거의 모든 소프트웨어를 배포하는 데에도 사용할 수 있습니다. 예를 들면, Hadoop 또는 Jenkins 등의 오픈소스 소프트웨어를 BOSH release로 작성하여 배포할 수 있으며 대규모 분산 시스템(system)에 적합합니다. <br />
또한 BOSH는 Amazon Web Services EC2, Google Cloud Platform, Microsoft Azure, OpenStack, VMware vSphere 및 Alibaba Cloud와 같은 다양한 IaaS(infrastructure as a service) provider를 지원하며, Apache CloudStack, VirtualBox 등의 IaaS provider 지원을 위해 CPI(cloud provider interface)를 제공합니다. <br />
이 포스트에서는 AWS EC2 우분투(ubuntu) 환경에서 BOSH 사용을 위한 BOSH director를 설치하는 방법을 소개합니다.</p>

<blockquote>
  <p>CFAR에 대해서는 본문의 <a href="#2-%EC%84%A0%ED%83%9D%EC%82%AC%ED%95%AD-cf-cli-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0">CF CLI 설치</a>에서 설명합니다.</p>
</blockquote>

<h2 id="선행조건prerequisite">선행조건(PREREQUISITE)</h2>
<ul>
  <li>AWS 환경이 필요합니다.
    <ul>
      <li>VPC 설정이 필요합니다.</li>
      <li>Subnet 설정이 필요합니다.</li>
      <li>Internet gateway 설정이 필요합니다.</li>
      <li>NAT Gateway 설정이 필요합니다.</li>
      <li>Routing table 설정이 필요합니다.</li>
      <li>security group 설정이 필요합니다.</li>
      <li>Quota 설정이 필요합니다.</li>
    </ul>
  </li>
  <li>AWS EC2 Inception VM이 필요합니다.
    <ul>
      <li>ubuntu 환경이 필요합니다.</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>BOSH director 설치를 위한 AWS 환경 설정 및 AWS EC2 Inception VM 생성 방법은 다음 포스트에서 소개하겠습니다.</p>
</blockquote>

<blockquote>
  <p>AWS, GCP, MS Azure, OpenStack, VMware vSphere 등 IaaS 환경에 BOSH director를 설치하여 BOSH를 사용하거나, 로컬(local) 환경에 BOSH-LITE를 설치하여 BOSH를 사용할 수 있습니다.</p>
</blockquote>

<blockquote>
  <p>Provisioning이란 사용자의 요구에 맞게 system 자원을 할당, 배치, 배포해 두었다가 필요 시 system을 즉시 사용할 수 있는 상태로 미리 준비해 두는 것을 의미합니다.</p>
</blockquote>

<blockquote>
  <p>Provisioning에 대한 자세한 정보는 <a href="https://ko.wikipedia.org/wiki/%ED%94%84%EB%A1%9C%EB%B9%84%EC%A0%80%EB%8B%9D" target="\_blank">https://ko.wikipedia.org/wiki/프로비저닝</a>, <a href="https://en.wikipedia.org/wiki/Provisioning_(telecommunications)" target="\_blank">https://en.wikipedia.org/wiki/Provisioning_(telecommunications)</a>를 확인해 주시기 바랍니다.</p>
</blockquote>

<blockquote>
  <p>Ubuntu 설치 방법은 <a href="https://lindarex.github.io/ubuntu/ubuntu-1604-installation/" target="\_blank">VMware workstation에 ubuntu server 16.04 설치하기</a> 또는 <a href="https://lindarex.github.io/ubuntu/ubuntu-1804-installation/" target="\_blank">VMware workstation에 ubuntu server 18.04 설치하기</a> 포스트를 참고하시기 바랍니다.</p>
</blockquote>

<h2 id="테스트-환경test-environment">테스트 환경(TEST ENVIRONMENT)</h2>
<ul>
  <li>AWS EC2</li>
  <li>Ubuntu 18.04.3 LTS (Bionic Beaver) Server (64-bit)</li>
</ul>

<h2 id="요약summary">요약(SUMMARY)</h2>
<ol>
  <li>BOSH CLI 설치</li>
  <li>(선택사항) CF CLI 설치</li>
  <li>CF UAA CLI 설치</li>
  <li>Credhub CLI 설치</li>
  <li>BOSH director 설치</li>
  <li>BOSH UAA 통합 인증</li>
  <li>BOSH director 설정</li>
  <li>BOSH jumpbox 설정</li>
  <li>Credhub 설정</li>
</ol>

<h2 id="내용contents">내용(CONTENTS)</h2>

<blockquote>
  <p>아래 명령어로 환경변수를 설정하고, workspace 디렉터리(directory)를 생성합니다.</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">export </span><span class="nv">LINDAREX_INCEPTION_USER_NAME</span><span class="o">=</span><span class="s1">'ubuntu'</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">export </span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="o">=</span>/home/<span class="k">${</span><span class="nv">LINDAREX_INCEPTION_USER_NAME</span><span class="k">}</span>/workspace
<span class="gp">$</span><span class="w"> </span><span class="nb">export </span><span class="nv">LINDAREX_BOSH_DIRECTOR</span><span class="o">=</span><span class="s1">'micro-bosh'</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">export </span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="o">=</span><span class="s1">'aws'</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">mkdir</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>
</code></pre></div></div>

<h3 id="1-bosh-cli-설치하기">1. BOSH CLI 설치하기</h3>
<ul>
  <li>BOSH CLI는 v1 버전과 v2 버전이 존재하며, 이 포스트에서는 v2 버전을 기준으로 설명합니다.</li>
</ul>

<h4 id="11-종속-패키지-설치">1.1. 종속 패키지 설치</h4>
<ul>
  <li>자신이 사용하는 ubuntu 버전에 따라 아래 명령어로 종속 패키지(package dependencies)를 설치합니다.</li>
</ul>

<blockquote>
  <p>ubuntu 18.04 (Bionic)</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>apt update <span class="nt">-y</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> build-essential zlibc zlib1g-dev ruby ruby-dev openssl libxslt1-dev libxml2-dev libssl-dev libreadline7 libreadline-dev libyaml-dev libsqlite3-dev sqlite3
</code></pre></div></div>

<blockquote>
  <p>ubuntu 16.04 (Xenial) 또는 ubuntu 14.04 (Trusty)</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>apt update <span class="nt">-y</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> libcurl4-openssl-dev gcc g++ build-essential zlibc zlib1g-dev ruby ruby-dev openssl libxslt-dev libxml2-dev libssl-dev libreadline6 libreadline6-dev libyaml-dev libsqlite3-dev sqlite3
</code></pre></div></div>

<h4 id="12-bosh-cli-파일file-내려받기">1.2. BOSH CLI 파일(file) 내려받기</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>curl <span class="nt">-Lo</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh https://github.com/cloudfoundry/bosh-cli/releases/download/v6.2.1/bosh-cli-6.2.1-linux-amd64
</code></pre></div></div>

<h4 id="13-chmodchange-mode-명령어로-file-권한-변경실행-권한-부여">1.3. chmod(change mode) 명령어로 file 권한 변경(실행 권한 부여)</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">chmod</span> +x <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh
</code></pre></div></div>

<h4 id="14-실행-file을-사용자-프로그램-경로path로-옮기기">1.4. 실행 file을 사용자 프로그램 경로(path)로 옮기기</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">sudo mv</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh /usr/local/bin/bosh
</code></pre></div></div>

<h4 id="15-bosh-cli-설치-확인">1.5. BOSH CLI 설치 확인</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>bosh <span class="nt">-v</span>
<span class="go">version 6.2.1-a28042ac-2020-02-10T18:40:57Z

Succeeded
</span></code></pre></div></div>

<h3 id="2-선택사항-cf-cli-설치하기">2. (선택사항) CF CLI 설치하기</h3>
<ul>
  <li>CF CLI에서 CF는 정확히 표현하면 CFAR(cloud foundry application runtime)입니다.</li>
  <li>CF CLI는 CFAR 명령어를 사용하기 위한 설치입니다.</li>
  <li>CFAR은 BOSH로 배포하며, 배포 방법은 다음 포스트에서 소개하겠습니다.</li>
</ul>

<blockquote>
  <p>CFAR은 CFCR(cloud foundry container runtime)이 생기기 전까지 CF(cloud foundry)로 불렸었고, CFCR도 Cloud Foundry Foundation incubating project 초반에는 kubo로 불렸습니다.</p>
</blockquote>

<blockquote>
  <p>최근 컨테이너 플랫폼(container platform)의 성장과 함께 Cloud Foundry도 kubernetes를 이용한 container runtime을 제공하면서, application runtime인 CF를 CFAR로, container runtime인 kubo를 CFCR로 명칭을 변경했습니다.</p>
</blockquote>

<h4 id="21-cf-cli-debian-packages-repository-key-추가">2.1. CF CLI Debian packages repository key 추가</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>wget <span class="nt">-q</span> <span class="nt">-O</span> - https://packages.cloudfoundry.org/debian/cli.cloudfoundry.org.key | <span class="nb">sudo </span>apt-key add -
</code></pre></div></div>

<h4 id="22-cf-cli-debian-packages-repository-추가">2.2. CF CLI Debian packages repository 추가</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"deb https://packages.cloudfoundry.org/debian stable main"</span> | <span class="nb">sudo tee</span> /etc/apt/sources.list.d/cloudfoundry-cli.list
</code></pre></div></div>

<h4 id="23-apt-install-명령어로-cf-cli-설치">2.3. apt install 명령어로 CF CLI 설치</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>apt update <span class="nt">-y</span> <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt <span class="nb">install </span>cf-cli <span class="nt">-y</span>
</code></pre></div></div>

<h4 id="24-cf-cli-설치-확인">2.4. CF CLI 설치 확인</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>cf <span class="nt">--version</span>
<span class="go">cf version 6.49.0+d0dfa93bb.2020-01-07
</span></code></pre></div></div>

<h3 id="3-cf-uaa-cli-설치하기">3. CF UAA CLI 설치하기</h3>
<ul>
  <li>UAA는 사용자 계정 및 인증 서버(User Account and Authentication server)입니다.</li>
  <li>UAA는 CFAR과 BOSH에 각각 존재하며, CF UAA CLI를 통해 모두 사용할 수 있습니다.</li>
</ul>

<h4 id="31-rubygems으로-cf-uaa-cli-설치">3.1. Rubygems으로 CF UAA CLI 설치</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>gem <span class="nb">install </span>cf-uaac
</code></pre></div></div>

<h4 id="32-cf-uaa-cli-설치-확인">3.2. CF UAA CLI 설치 확인</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>uaac <span class="nt">-v</span>
<span class="go">UAA client 4.2.0
</span></code></pre></div></div>

<h3 id="4-credhub-cli-설치">4. Credhub CLI 설치</h3>
<ul>
  <li>CredHub는 비밀번호, 인증서(certificates), 인증 기관(certificate authorities), ssh 키, rsa 키와 같은 credentials 정보를 관리합니다.</li>
</ul>

<h4 id="41-credhub-cli-file-내려받기">4.1. Credhub CLI file 내려받기</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>wget <span class="nt">-P</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span> https://github.com/cloudfoundry-incubator/credhub-cli/releases/download/2.6.2/credhub-linux-2.6.2.tgz
</code></pre></div></div>

<h4 id="42-내려받은-file-압축-해제">4.2. 내려받은 file 압축 해제</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">tar </span>zxf <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/credhub-linux-2.6.2.tgz <span class="nt">-C</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>
</code></pre></div></div>

<h4 id="43-chmod-명령어로-file-권한-변경실행-권한-부여">4.3. chmod 명령어로 file 권한 변경(실행 권한 부여)</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">chmod</span> +x <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/credhub
</code></pre></div></div>

<h4 id="44-실행-file을-사용자-프로그램-path로-옮기기">4.4. 실행 file을 사용자 프로그램 path로 옮기기</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">sudo mv</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/credhub /usr/local/bin/credhub
</code></pre></div></div>

<h4 id="45-credhub-cli-설치-확인">4.5. Credhub CLI 설치 확인</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>credhub <span class="nt">--version</span>
<span class="go">CLI Version: 2.6.2
Server Version: Not Found. Have you targeted and authenticated against a CredHub server?
</span></code></pre></div></div>

<h3 id="5-bosh-director-설치">5. BOSH director 설치</h3>
<h4 id="51-bosh-deployment-repository-clone-받기">5.1. BOSH deployment repository clone 받기</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>git clone https://github.com/cloudfoundry/bosh-deployment.git <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment
</code></pre></div></div>

<blockquote>
  <p>Cloud Foundry github repository에서 제공하는 BOSH deployment는 branch나 tag가 존재하지 않습니다. Clone 받는 당시의 버전으로 설치를 해야 하며, 간혹 오류를 포함한 버전도 배포되곤 합니다.</p>
</blockquote>

<h4 id="52-배포-스크립트script-작성">5.2. 배포 스크립트(script) 작성</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>vi <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/deploy-<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>.sh
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--------------------------------------------------------------------------------</span>
<span class="c">#!/bin/bash</span>

bosh create-env bosh.yml <span class="se">\</span>
	<span class="nt">--state</span><span class="o">=</span>aws/state.json <span class="se">\</span>
	<span class="nt">--vars-store</span><span class="o">=</span>aws/creds.yml <span class="se">\</span>
	<span class="nt">-o</span> aws/cpi.yml <span class="se">\</span>
	<span class="nt">-o</span> uaa.yml <span class="se">\</span>
	<span class="nt">-o</span> credhub.yml <span class="se">\</span>
	<span class="nt">-o</span> jumpbox-user.yml <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">internal_cidr</span><span class="o">=</span><span class="s1">'10.0.1.0/24'</span> <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">internal_gw</span><span class="o">=</span><span class="s1">'10.0.1.1'</span> <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">internal_ip</span><span class="o">=</span><span class="s1">'10.0.1.6'</span> <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">director_name</span><span class="o">=</span><span class="s1">'micro-bosh'</span> <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">access_key_id</span><span class="o">=</span><span class="s1">'AKIBI7UEWB42Q4THBBFQ'</span> <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">secret_access_key</span><span class="o">=</span><span class="s1">'br3K3YQM7SwvyP/0G4AJozpSLUFwaBxy+KRFy+3q'</span> <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">region</span><span class="o">=</span><span class="s1">'ap-northeast-2'</span> <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">az</span><span class="o">=</span><span class="s1">'ap-northeast-2c'</span> <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">default_key_name</span><span class="o">=</span><span class="s1">'lindarex-inception'</span> <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">default_security_groups</span><span class="o">=[</span>lindarex-security] <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">subnet_id</span><span class="o">=</span><span class="s1">'subnet-087f7203d0bcd1396'</span> <span class="se">\</span>
	<span class="nt">-v</span> <span class="nv">private_key</span><span class="o">=</span><span class="s1">'~/.ssh/lindarex-inception.pem'</span>
<span class="nt">--------------------------------------------------------------------------------</span>
</code></pre></div></div>

<ul>
  <li>‘-o’ 옵션은 YAML로 작성된 옵션 file의 path를 지정하여 배포 시에 적용합니다.</li>
  <li>
    <p>‘-v’ 옵션은 변수를 설정하여 배포 시에 적용합니다.</p>
  </li>
  <li>배포 script를 상세하게 설명하겠습니다.
    <ul>
      <li>‘create-env’ :: BOSH director를 배포하는 명령어입니다.</li>
      <li>‘bosh.yml’ :: 설정한 YAML file을 기반으로 Single VM을 생성합니다.</li>
      <li>’–state’ :: 배포 상태 file의 path입니다.</li>
      <li>’–vars-store’ :: Credentials 정보를 저장하는 YAML file의 path입니다.</li>
      <li>‘-o aws/cpi.yml’ :: AWS CPI를 적용합니다. IaaS 마다 CPI가 다릅니다.</li>
      <li>‘-o uaa.yml’ :: UAA를 적용합니다.</li>
      <li>‘-o credhub.yml’ :: Credhub을 적용합니다.</li>
      <li>‘-o jumpbox-user.yml’ :: Jumpbox user를 적용합니다. BOSH director VM에 SSH 접속을 할 수 있습니다.</li>
      <li>‘-v internal_cidr’ :: BOSH director VM에 적용할 네트워크(network)의 cidr입니다.</li>
      <li>‘-v internal_gw’ :: BOSH director VM에 적용할 network의 gateway ip입니다.</li>
      <li>‘-v internal_ip’ :: BOSH director VM에 적용할 network의 private ip입니다.</li>
      <li>‘-v director_name’ :: BOSH director 이름입니다. BOSH login할 때 사용합니다.</li>
      <li>‘-v access_key_id’ :: IaaS가 AWS인 경우 필요한 변수이며, AWS access key id입니다.</li>
      <li>‘-v secret_access_key’ :: IaaS가 AWS인 경우 필요한 변수이며, AWS secret access key입니다.</li>
      <li>‘-v region’ :: IaaS가 AWS인 경우 필요한 변수이며, AWS region입니다.</li>
      <li>‘-v az’ :: IaaS가 AWS인 경우 필요한 변수이며, AWS az(가용 영역, availability zone)입니다.</li>
      <li>‘-v default_key_name’ :: IaaS가 AWS인 경우 필요한 변수이며, AWS key name입니다.</li>
      <li>‘-v default_security_groups’ :: IaaS가 AWS인 경우 필요한 변수이며, AWS security_group입니다.</li>
      <li>‘-v subnet_id’ :: IaaS가 AWS인 경우 필요한 변수이며, BOSH director VM에 적용할 network의 subnet id입니다.</li>
      <li>‘-v private_key’ :: IaaS가 AWS인 경우 필요한 변수이며, AWS private key file의 path입니다.</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>위 배포 script는 AWS 서울 region에 배포되는 설정이지만, region과 az를 제외한 AWS 설정값은 잘못된 값이므로 참고만 하시기를 바랍니다.</p>
</blockquote>

<h4 id="53-chmod-명령어로-file-권한-변경실행-권한-부여">5.3. chmod 명령어로 file 권한 변경(실행 권한 부여)</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">chmod</span> +x <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/deploy-<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>.sh
</code></pre></div></div>

<h4 id="54-선택사항-배포-상태-file-삭제">5.4. (선택사항) 배포 상태 file 삭제</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">rm</span> <span class="nt">-rf</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>/state.json
<span class="gp">$</span><span class="w"> </span><span class="nb">rm</span> <span class="nt">-rf</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>/creds.yml
</code></pre></div></div>

<blockquote>
  <p>state.json file과 creds.yml file은 배포 성공 여부와 관계없이 ‘bosh create-env’ 명령어를 한 번이라도 실행하면 생성되는 file입니다.</p>
</blockquote>

<h4 id="55-배포-script-실행">5.5. 배포 script 실행</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">cd</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment
<span class="gp">$</span><span class="w"> </span>./deploy-<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>.sh
</code></pre></div></div>

<h3 id="6-bosh-uaa-통합-인증">6. BOSH UAA 통합 인증</h3>
<h4 id="61-bosh-uaa-target-설정">6.1. BOSH UAA target 설정</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>uaac target https://10.0.1.6:8443 <span class="nt">--skip-ssl-validation</span>
<span class="go">Unknown key: Max-Age = 86400

Target: https://10.0.1.6:8443

</span></code></pre></div></div>

<h4 id="62-client-credentials-grant를-통해-uaa-admin-token-얻기">6.2. Client credentials grant를 통해 UAA admin token 얻기</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>uaac token client get uaa_admin <span class="nt">-s</span> <span class="sb">`</span>bosh int <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>/creds.yml <span class="nt">--path</span> /uaa_admin_client_secret<span class="sb">`</span>
<span class="go">Unknown key: Max-Age = 86400

Successfully fetched token via client credentials grant.
Target: https://10.0.1.6:8443
Context: uaa_admin, from client uaa_admin

</span></code></pre></div></div>

<h4 id="63-uaa-admin-token-파싱-및-clients-목록-조회">6.3. UAA admin token 파싱 및 clients 목록 조회</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>uaac token decode <span class="o">&amp;&amp;</span> uaac clients
<span class="go">
Note: no key given to validate token signature

  jti: 1b82b1e6cfbb4606a182d5ab88c28b8d
  sub: uaa_admin
  authorities: clients.read password.write clients.secret clients.write uaa.admin scim.write scim.read
  scope: clients.read password.write clients.secret clients.write uaa.admin scim.write scim.read
  client_id: uaa_admin
  cid: uaa_admin
  azp: uaa_admin
  revocable: true
  grant_type: client_credentials
  rev_sig: 34bac1ad
  iat: 1573525863
  exp: 1573569063
  iss: https://10.0.1.6:8443/oauth/token
  zid: uaa
  aud: scim uaa_admin password clients uaa
  admin
    scope: uaa.none
    resource_ids: none
    authorized_grant_types: client_credentials
    autoapprove:
    authorities: bosh.admin
    lastmodified: 1573525068032
  bosh_cli
    scope: openid bosh.admin bosh.read bosh.*.admin bosh.*.read bosh.teams.*.admin bosh.teams.*.read
    resource_ids: none
    authorized_grant_types: password refresh_token
    autoapprove:
    access_token_validity: 120
    refresh_token_validity: 86400
    authorities: uaa.none
    lastmodified: 1573525068153
  credhub-admin
    scope: uaa.none
    resource_ids: none
    authorized_grant_types: client_credentials
    autoapprove:
    access_token_validity: 3600
    authorities: credhub.write credhub.read
    lastmodified: 1573525068271
  credhub_cli
    scope: credhub.read credhub.write
    resource_ids: none
    authorized_grant_types: password refresh_token
    autoapprove:
    access_token_validity: 60
    refresh_token_validity: 1800
    authorities: uaa.none
    lastmodified: 1573525068386
  director_to_credhub
    scope: uaa.none
    resource_ids: none
    authorized_grant_types: client_credentials
    autoapprove:
    access_token_validity: 3600
    authorities: credhub.write credhub.read
    lastmodified: 1573525068492
  hm
    scope: uaa.none
    resource_ids: none
    authorized_grant_types: client_credentials
    autoapprove:
    authorities: bosh.admin
    lastmodified: 1573525068590
  uaa_admin
    scope: uaa.none
    resource_ids: none
    authorized_grant_types: client_credentials
    autoapprove:
    authorities: clients.read password.write clients.secret clients.write uaa.admin scim.write scim.read
    lastmodified: 1573525068689
</span></code></pre></div></div>

<h3 id="7-bosh-director-설정">7. BOSH director 설정</h3>
<h4 id="71-local-alias-설정">7.1. Local alias 설정</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">export </span><span class="nv">BOSH_CLIENT</span><span class="o">=</span><span class="s1">'admin'</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">export </span><span class="nv">BOSH_CLIENT_SECRET</span><span class="o">=</span><span class="sb">`</span>bosh int <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>/creds.yml <span class="nt">--path</span> /admin_password<span class="sb">`</span>
<span class="gp">$</span><span class="w"> </span>bosh alias-env <span class="k">${</span><span class="nv">LINDAREX_BOSH_DIRECTOR</span><span class="k">}</span> <span class="nt">-e</span> 10.0.1.6 <span class="nt">--ca-cert</span> &lt;<span class="o">(</span>bosh int <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>/creds.yml <span class="nt">--path</span> /director_ssl/ca<span class="o">)</span>
</code></pre></div></div>

<h4 id="72-bosh-로그인">7.2. BOSH 로그인</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>bosh <span class="nt">-e</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_DIRECTOR</span><span class="k">}</span> l
<span class="go">Successfully authenticated with UAA

Succeeded
</span></code></pre></div></div>

<h4 id="73-bosh-director-정보-조회">7.3. BOSH director 정보 조회</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>bosh <span class="nt">-e</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_DIRECTOR</span><span class="k">}</span> <span class="nb">env</span>
<span class="go">Using environment '10.0.1.6' as client 'admin'

Name               micro-bosh
UUID               b002986f-3a05-441a-be08-3a46dbe29a8a
Version            270.5.0 (00000000)
Director Stemcell  ubuntu-xenial/456.27
CPI                aws_cpi
Features           compiled_package_cache: disabled
                   config_server: enabled
                   local_dns: enabled
                   power_dns: disabled
                   snapshots: disabled
User               admin

Succeeded
</span></code></pre></div></div>

<h4 id="74-선택사항-사용자-프로필에-bosh-director-정보-추가">7.4. (선택사항) 사용자 프로필에 BOSH director 정보 추가</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>vi <span class="nv">$HOME</span>/.profile
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--------------------------------------------------------------------------------</span>
<span class="nb">export </span><span class="nv">LINDAREX_INCEPTION_USER_NAME</span><span class="o">=</span><span class="s1">'ubuntu'</span>
<span class="nb">export </span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="o">=</span>/home/<span class="k">${</span><span class="nv">LINDAREX_INCEPTION_USER_NAME</span><span class="k">}</span>/workspace
<span class="nb">export </span><span class="nv">LINDAREX_BOSH_DIRECTOR</span><span class="o">=</span><span class="s1">'micro-bosh'</span>
<span class="nb">export </span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="o">=</span><span class="s1">'aws'</span>
<span class="nb">export </span><span class="nv">BOSH_ENVIRONMENT</span><span class="o">=</span><span class="s1">'10.0.1.6'</span>
<span class="nb">export </span><span class="nv">BOSH_CLIENT</span><span class="o">=</span><span class="s1">'admin'</span>
<span class="nb">export </span><span class="nv">BOSH_CLIENT_SECRET</span><span class="o">=</span><span class="sb">`</span>bosh <span class="nt">-e</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_DIRECTOR</span><span class="k">}</span> int <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>/creds.yml <span class="nt">--path</span> /admin_password<span class="sb">`</span>
<span class="nt">--------------------------------------------------------------------------------</span>
</code></pre></div></div>

<blockquote>
  <p>수정 내역 적용을 위해 아래 명령어를 입력합니다.</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">source</span> <span class="nv">$HOME</span>/.profile
</code></pre></div></div>

<h3 id="8-bosh-jumpbox-설정">8. BOSH jumpbox 설정</h3>
<h4 id="81-jumpbox-key-생성">8.1. Jumpbox key 생성</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">cd</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment
<span class="gp">$</span><span class="w"> </span>bosh int <span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>/creds.yml <span class="nt">--path</span> /jumpbox_ssh/private_key <span class="o">&gt;</span> jumpbox.key
</code></pre></div></div>

<h4 id="82-chmod-명령어로-file-권한-변경소유자만-읽기-및-쓰기-권한-부여">8.2. chmod 명령어로 file 권한 변경(소유자만 읽기 및 쓰기 권한 부여)</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">chmod </span>600 jumpbox.key
</code></pre></div></div>

<h4 id="83-bosh-director-vm에-ssh-접속">8.3. BOSH director VM에 SSH 접속</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>ssh jumpbox@<span class="k">${</span><span class="nv">BOSH_ENVIRONMENT</span><span class="k">}</span> <span class="nt">-i</span> <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/jumpbox.key
<span class="go">The authenticity of host '10.0.1.6 (10.0.1.6)' can't be established.
ECDSA key fingerprint is SHA256:Lc0OsEocqPAEgAk0c1X7Y7y+iNWqeFMGkfFFLRlA8ww.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '10.0.1.6' (ECDSA) to the list of known hosts.
Unauthorized use is strictly prohibited. All access and activity
is subject to logging and monitoring.
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-54-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

</span><span class="gp">The programs included with the Ubuntu system are free software;</span><span class="w">
</span><span class="go">the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Tue Feb 18 07:23:17 2020 from 10.0.201.149
</span><span class="gp">To run a command as administrator (user "root"), use "sudo &lt;command&gt;</span><span class="s2">".
</span><span class="go">See "man sudo_root" for details.

</span><span class="gp">bosh/0:~$</span><span class="w"> 
</span></code></pre></div></div>

<h4 id="84-bosh-director-vm의-외부-통신-상태-확인">8.4. BOSH director VM의 외부 통신 상태 확인</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">bosh/0:~$</span><span class="w"> </span><span class="nb">sudo </span>ping 8.8.8.8
<span class="go">PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=53 time=30.8 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=53 time=29.1 ms
^C
--- 8.8.8.8 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1000ms
rtt min/avg/max/mdev = 29.135/30.009/30.884/0.891 ms
</span></code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">bosh/0:~$</span><span class="w"> </span>wget https://wordpress.org/latest.zip
</code></pre></div></div>

<blockquote>
  <p>아래 명령어로 BOSH director VM의 SSH 접속을 종료할 수 있습니다.</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">bosh/0:~$</span><span class="w"> </span><span class="nb">exit</span>
<span class="go">logout
Connection to 10.0.1.6 closed.
</span></code></pre></div></div>

<h3 id="9-credhub-설정">9. Credhub 설정</h3>
<h4 id="91-credhub-api-server-설정">9.1. Credhub api server 설정</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>credhub api <span class="se">\</span>
<span class="nt">--ca-cert</span><span class="o">=</span>&lt;<span class="o">(</span>bosh int <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>/creds.yml <span class="nt">--path</span> /credhub_ca/ca<span class="o">)</span> <span class="se">\</span>
<span class="nt">--ca-cert</span><span class="o">=</span>&lt;<span class="o">(</span>bosh int <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>/creds.yml <span class="nt">--path</span> /uaa_ssl/ca<span class="o">)</span> <span class="se">\</span>
<span class="nt">--server</span><span class="o">=</span>10.0.1.6:8844
<span class="go">Setting the target url: https://10.0.1.6:8844
</span></code></pre></div></div>

<h4 id="92-credhub-로그인">9.2. Credhub 로그인</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>credhub login <span class="nt">--client-name</span><span class="o">=</span>credhub-admin <span class="nt">--client-secret</span><span class="o">=</span><span class="sb">`</span>bosh int <span class="k">${</span><span class="nv">LINDAREX_BOSH_WORKSPACE</span><span class="k">}</span>/bosh-deployment/<span class="k">${</span><span class="nv">LINDAREX_BOSH_IAAS</span><span class="k">}</span>/creds.yml <span class="nt">--path</span> /credhub_admin_client_secret<span class="sb">`</span>
<span class="go">Login Successful
</span></code></pre></div></div>

<h4 id="93-credentials-전체-조회">9.3. credentials 전체 조회</h4>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>credhub find
<span class="go">credentials: []
</span></code></pre></div></div>

<h2 id="마무리conclusion">마무리(CONCLUSION)</h2>
<p>AWS EC2 ubuntu 환경에 BOSH director 설치를 완료했습니다. <br />
BOSH director 설치는 CFAR 및 CFCR 등 BOSH release 배포를 위한 기반 작업이며, 설치 진행을 위해서는 적지 않은 IaaS 설정이 필요합니다. <br />
다음 포스트에서는 BOSH director 설치를 위한 AWS 환경 설정과 AWS EC2 Inception VM 생성 방법, BOSH components에 대한 설명과 BOSH release 작성 방법을 소개하겠습니다.</p>

<h2 id="참고references">참고(REFERENCES)</h2>
<ul>
  <li><a href="https://bosh.io/docs/cli-v2-install/" target="\_blank">https://bosh.io/docs/cli-v2-install/</a></li>
  <li><a href="https://github.com/cloudfoundry/bosh-cli/releases" target="\_blank">https://github.com/cloudfoundry/bosh-cli/releases</a></li>
  <li><a href="https://docs.cloudfoundry.org/cf-cli/install-go-cli.html" target="\_blank">https://docs.cloudfoundry.org/cf-cli/install-go-cli.html</a></li>
  <li><a href="https://github.com/cloudfoundry/cf-uaac" target="\_blank">https://github.com/cloudfoundry/cf-uaac</a></li>
  <li><a href="https://github.com/cloudfoundry-incubator/credhub-cli" target="\_blank">https://github.com/cloudfoundry-incubator/credhub-cli</a></li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/aws" class="page__taxonomy-item" rel="tag">aws</a><span class="sep">, </span>
    
      
      
      <a href="/tags/bosh" class="page__taxonomy-item" rel="tag">bosh</a><span class="sep">, </span>
    
      
      
      <a href="/tags/ec2" class="page__taxonomy-item" rel="tag">ec2</a><span class="sep">, </span>
    
      
      
      <a href="/tags/ubuntu" class="page__taxonomy-item" rel="tag">ubuntu</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/bosh" class="page__taxonomy-item" rel="tag">bosh</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-02-20T00:00:00+09:00">February 20, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=AWS+EC2+%EC%9A%B0%EB%B6%84%ED%88%AC%28Ubuntu%29+%ED%99%98%EA%B2%BD%EC%97%90+BOSH+director+%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0%20https%3A%2F%2Flindarex.github.io%2Fbosh%2Fubuntu-bosh-director-installation%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flindarex.github.io%2Fbosh%2Fubuntu-bosh-director-installation%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Flindarex.github.io%2Fbosh%2Fubuntu-bosh-director-installation%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/aws/ubuntu-aws-cli-installation/" class="pagination--pager" title="우분투(Ubuntu) 환경에 AWS CLI 설치하기
">Previous</a>
    
    
      <a href="/travis-ci/travis-github-pages-jekyll-setting/" class="pagination--pager" title="Travis CI로 Jekyll 블로그를 GitHub Pages에 자동 배포하기
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Leave a comment</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/LindaRex_LOGO.jpg"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/jenkins/ubuntu-jenkins-war-installation/" rel="permalink">우분투(Ubuntu) 환경에 WAR 파일로 젠킨스(Jenkins) 설치하기
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">젠킨스(Jenkins)를 설치하는 방법은 다양합니다. 패키지(package)로 jenkins를 설치하는 방법은 우분투(Ubuntu) 환경에 패키지(Package)로 젠킨스(Jenkins) 설치하기 포스트를 참고하시기 바랍니다. 
이 포스트에서는 우분투(ubuntu) 환경에서 WAR...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/LindaRex_LOGO.jpg"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/ubuntu/ubuntu-initial-setting/" rel="permalink">우분투(Ubuntu) 서버(Server) 초기 설정하기
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">이 포스트에서는 우분투(ubuntu) 서버(server) 설치 후 초기 설정하는 방법을 소개합니다.

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/LindaRex_LOGO.jpg"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/ubuntu/ubuntu-iptables-setting/" rel="permalink">우분투(Ubuntu) 환경에 iptables 설정하기
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">iptables은 방화벽(firewall) 구성이나 NAT(network address translation)에 사용되는데, 리눅스(linux) 커널(kernel) firewall이 제공하는 테이블(table)과 체인(chain), 규칙(rule)을 시스템 관리자가 구성합니다. 
...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/LindaRex_LOGO.jpg"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/cfar/cloud-foundry-projects-introduction/" rel="permalink">클라우드 파운드리(Cloud Foundry) 프로젝트(projects) 소개
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">이 포스트에서는 클라우드 파운드리(Cloud Foundry) 프로젝트(projects)를 간단히 소개합니다.

</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- LINDAREX :: GOOGLE ADSENSE :: FOOTER :: BIGIN -->
        <!-- LINDAREX :: GOOGLE ADSENSE :: FOOTER :: HTML ::  BIGIN -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 2020-02-22-ad-footer -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8367174639781348"
     data-ad-slot="1870387544"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<!-- LINDAREX :: GOOGLE ADSENSE :: FOOTER :: HTML ::  END -->
        <!-- LINDAREX :: GOOGLE ADSENSE :: FOOTER :: END -->
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://github.com/lindarex/lindarex.github.io" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 LindaRex. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>
    <!-- LINDAREX :: BACK TO TOP :: BEGIN -->
    <!-- <aside class="sidebar__top">
      <a href="#site-nav"> <i class="fas fa-angle-double-up fa-2x"></i></a>
    </aside> -->
    <!-- LINDAREX :: BACK TO TOP :: END -->

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "https://lindarex.github.io/bosh/ubuntu-bosh-director-installation/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/bosh/ubuntu-bosh-director-installation"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://lindarex-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
